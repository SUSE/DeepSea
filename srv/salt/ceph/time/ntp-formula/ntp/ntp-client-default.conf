# This file managed by Salt (DeepSea); do not edit
#
#

# By default, exchange time with everybody, but don't allow configuration
restrict -4  default notrap nomodify nopeer noquery
restrict -6  default notrap nomodify nopeer noquery

# Local users may interrogate the ntp server more closely
restrict 127.0.0.1
restrict ::1

# Miscellaneous
driftfile /var/lib/ntp/drift/ntp.drift  # path for drift file
logfile   /var/log/ntp                  # alternate log file

# Authentication stuff
keys /etc/ntp.keys              # path for keys file
trustedkey 1                    # define trusted keys
requestkey 1                    # key (7) for accessing server variables
controlkey 1                    # key (6) for accessing server variables

{% if salt['pillar.get']('time_service:ntp_server') %}
	{% set ntpservers = [ salt['pillar.get']('time_service:ntp_server') ] %}
{% else %}
	{% set ntpservers = salt['pillar.get']('time_service:higher_stratum_servers', [
		'0.pool.ntp.org',
		'1.pool.ntp.org',
		'2.pool.ntp.org',
		'3.pool.ntp.org'
	]) %}
{% endif %}

{% for ntpserver in ntpservers %}
server {{ ntpserver }} iburst
{% endfor %}
